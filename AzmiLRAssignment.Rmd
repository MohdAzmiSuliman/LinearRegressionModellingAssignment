---
title: "Linear Regression Modelling Assignment"
author: "Mohd Azmi"
date: "22/10/2019"
output: html_document
---

# Pre-amble

## Loading Library

```{r Loading Library}
library(foreign)
library(tidyverse)
library(corrplot)
library(knitr)
library(broom)
library(tidyr)
library(psych)
```


## Loading Dataset

```{r}
Data01 <- read.spss("weights.sav", use.value.label=T, to.data.frame=T)
```

# Modelling

## Descriptive

```{r Descriptive Exploratory}
summary(Data01)
Data01 %>% describe()
```

## Data Exploration

Histogram

```{r Explore Numerical}
ggplot(Data01, aes(weight)) + geom_histogram()
ggplot(Data01, aes(length)) + geom_histogram()
ggplot(Data01, aes(headc)) + geom_histogram()

```

correlation Matrix and Correlogram

```{r Correlation and Correllogram}
Data02 <- Data01 %>% 
  select_if(is.numeric)
  
CorData02 <- cor(Data02, use = "complete.obs", method = "pearson")
head(round(CorData02,2))

corrplot(CorData02, method = "circle")
```

## Univariate

### Model 1

outcome: Head Circumference
covariate: weight

```{r LM Model01}

ModelWeight <- lm(headc ~ weight, data = Data01)
summary(ModelWeight)
tidy(ModelWeight, conf.int = T)
```

### Model 2

outcome: Head Circumference
covariate: length

```{r LM Model02}

ModelLength <- lm(headc ~ length, data = Data01)
summary(ModelLength)
tidy(ModelLength, conf.int = T)
```

### Model 3

outcome: Head Circumference
covariate: gender

```{r LM Model03}

ModelGender <- lm(headc ~ gender, data = Data01)
summary(ModelGender)
tidy(ModelGender, conf.int = T)
```

### Model 4

outcome: Head Circumference
covariate: Mother's Education

```{r LM Model04}

ModelEducation <- lm(headc ~ educatio, data = Data01)
summary(ModelEducation)
tidy(ModelEducation, conf.int = T)
```

### Model 5

outcome: Head Circumference
covariate: parity

```{r LM Model05}

ModelParity <- lm(headc ~ parity, data = Data01)
summary(ModelParity)
tidy(ModelParity, conf.int = T)
```

### Univariable Summary

all simple linear regressions were significant, except for variable mother education.

# Multivariable

To explore which covariate is the predictor for newborn's head circumference, several multiple linear regression models are created.

## Model Exploration

### Model 11

Outcome: Head Circumference
Covariate: Weight and Length

```{r LM ModelWeightLength}

ModelWeightLength <- lm(headc ~ weight + length, data = Data01)
summary(ModelWeightLength)
tidy(ModelWeightLength, conf.int = T)
```

### Model 12

Outcome: Head Circumference
Covariate: Weight, Length + gender + mother education + parity

```{r LM ModelWtLtGenEduPar}

ModelWtLtGenEduPar <- lm(headc ~ weight + length + gender + educatio + parity, data = Data01)
summary(ModelWtLtGenEduPar)
tidy(ModelWtLtGenEduPar, conf.int = T)
```

### Model 13

Outcome: Head Circumference
Covariate: Weight, Length + gender + parity

```{r LM ModelWtLtGenPar}

ModelWtLtGenPar <- lm(headc ~ weight + length + gender + parity, data = Data01)
summary(ModelWtLtGenEduPar)
tidy(ModelWtLtGenPar, conf.int = T)
```

## Model Comparison

```{r Model Comparison}
anova(ModelWeightLength, ModelWtLtGenEduPar)
anova(ModelWeightLength, ModelWtLtGenPar)
anova(ModelWtLtGenEduPar, ModelWtLtGenPar)
```

For model comparison, between ModelWtLtGenEduPar and ModelWtLtGenPar, there is no significant different. Thus, ModelWtLtGenEduPar is not selected. 

Thus, to choose either ModelWeightLength or ModelWtLtGenPar, adjusted R<sup>2</sup> will be use as guidance.

for ModelWeightLength, the adjusted R<sup>2</sup> is 0.4339, while ModelWtLtGenPar, adjusted R<sup>2</sup>is 0.4452. thus ModelWtLtGenPar is choosed.

## Handling Confounding

There is high correlation between variable weight and length.

```{r Confounder Exploration}
ggplot(Data01, aes(weight, length)) + geom_point() + stat_smooth(method = 'lm', col = 'green')
```


### Model 21

outcome: head circumference
covariate: Gender + Parity + Weight

```{r ModelGenParWt}
ModelGenParWt <- lm(headc ~ weight + gender + parity, data = Data01)
summary(ModelGenParWt)
tidy(ModelGenParWt, conf.int = T)

```

### Model 22

outcome: head circumference
covariate: Gender + Parity + Length

```{r ModelGenParLt}
ModelGenParLt <- lm(headc ~ weight + gender + parity, data = Data01)
summary(ModelGenParLt)
tidy(ModelGenParLt, conf.int = T)
```

### Model 23

outcome: head circumference
covariate: Gender + Parity + Weight + Length

```{r ModelGenParWLt}
ModelGenParWtLt <- lm(headc ~ weight + length + gender + parity, data = Data01)
summary(ModelGenParWtLt)
tidy(ModelGenParWtLt, conf.int = T)
```

